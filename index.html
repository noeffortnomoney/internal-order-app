<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>G·ª≠i ƒë∆°n h√†ng n·ªôi b·ªô</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#f5f6f8;margin:0;color:#333}
    .menu{background:#0a6c3d;padding:12px 20px;display:flex;gap:22px;align-items:center}
    .menu a{color:#fff;text-decoration:none;font-weight:600;cursor:pointer;opacity:.85}
    .menu a.active{opacity:1;border-bottom:2px solid #fff;padding-bottom:2px}
    .container{padding:20px;max-width:1200px;margin:auto}
    h2{margin-top:0}
    .page{display:none}
    .page.active{display:block}

    .card{background:#fff;padding:18px 20px;margin-bottom:18px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
    .card h3{margin-top:0;margin-bottom:12px}

    .form-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px 24px}
    label{font-size:13px;font-weight:600}
    input,textarea,select{width:100%;padding:8px 10px;margin-top:6px;border:1px solid #ccc;border-radius:6px;font-size:14px}
    input:disabled{background:#f0f0f0;color:#666}

    table{width:100%;border-collapse:collapse;background:#fff}
    th,td{border:1px solid #e0e0e0;padding:8px 10px;font-size:14px}
    th{background:#f3f4f6;text-align:left}

    .btn{padding:8px 14px;border-radius:6px;border:none;font-size:14px;font-weight:600;cursor:pointer}
    .btn-primary{background:#0a6c3d;color:#fff}
    .btn-outline{background:#fff;border:1px solid #0a6c3d;color:#0a6c3d}
    .btn-danger{background:#d32f2f;color:#fff}
    .btn + .btn{margin-left:8px}

    .actions-right{text-align:right;margin-top:10px}

    .popup-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);align-items:center;justify-content:center;z-index:1000}
    .popup{background:#fff;border-radius:8px;padding:20px 24px;width:420px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
    .popup label{display:block;margin-top:10px}
    .popup input,.popup textarea,.popup select{box-sizing:border-box}
  </style>
</head>
<body>

<nav class="menu">
  <a data-page="create" class="active">‚ûï T·∫°o g·ª≠i ƒë∆°n</a>
  <a data-page="list">üìã Danh s√°ch g·ª≠i ƒë∆°n</a>
</nav>

<div class="container">

  <!-- PAGE CREATE -->
  <div id="page-create" class="page active">
    <h2>T·∫°o g·ª≠i ƒë∆°n h√†ng n·ªôi b·ªô</h2>

    <div class="card">
      <h3>1. Th√¥ng tin g·ª≠i ƒë∆°n</h3>
      <div class="form-grid">
        <div>
          <label>ƒê∆°n v·ªã g·ª≠i</label>
          <select id="c_sender"></select>
        </div>
        <div>
          <label>ƒê∆°n v·ªã nh·∫≠n <span style="color:red">*</span></label>
          <select id="c_receiver"></select>
        </div>
        <div>
          <label>Ng∆∞·ªùi nh·∫≠n</label>
          <input id="c_contact" type="text" />
        </div>
        <div>
          <label>Ng√†y mong mu·ªën giao *</label>
          <input id="c_date" type="date" />
        </div>
        <div style="grid-column:1/3">
          <label>L√Ω do g·ª≠i *</label>
          <input id="c_reason" type="text" />
        </div>
        <div style="grid-column:1/3">
          <label>Ghi ch√∫</label>
          <textarea id="c_note" rows="2"></textarea>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>2. Danh s√°ch h√†ng g·ª≠i</h3>
      <div class="actions-right">
        <button type="button" class="btn btn-outline" onclick="openItemPopup()">‚ûï Th√™m h√†ng</button>
      </div>
      <table id="create-items">
        <thead>
          <tr><th>STT</th><th>T√™n</th><th>Quy c√°ch</th><th>ƒêVT</th><th>S·ªë l∆∞·ª£ng</th><th>Ghi ch√∫</th><th>Thao t√°c</th></tr>
        </thead>
        <tbody>
          <tr><td colspan="7" style="text-align:center;color:#888">Ch∆∞a c√≥ h√†ng g·ª≠i</td></tr>
        </tbody>
      </table>
    </div>

    <div class="actions-right">
      <button type="button" class="btn btn-primary" onclick="submitCreate()">üì§ G·ª≠i duy·ªát</button>
    </div>
  </div>

  <!-- PAGE LIST -->
  <div id="page-list" class="page">
    <h2>Danh s√°ch g·ª≠i ƒë∆°n h√†ng n·ªôi b·ªô</h2>

    <!-- SEARCH -->
    <div class="card">
      <h3>T√¨m ki·∫øm</h3>
      <div class="form-grid">
        <div>
          <label>T·ª´ ng√†y</label>
          <input type="date" id="s_from" />
        </div>
        <div>
          <label>ƒê·∫øn ng√†y</label>
          <input type="date" id="s_to" />
        </div>
        <div>
          <label>ƒê∆°n v·ªã g·ª≠i</label>
          <select id="s_sender"><option value="">-- T·∫•t c·∫£ --</option></select>
        </div>
        <div>
          <label>ƒê∆°n v·ªã nh·∫≠n</label>
          <select id="s_receiver"><option value="">-- T·∫•t c·∫£ --</option></select>
        </div>
        <div>
          <label>Tr·∫°ng th√°i</label>
          <select id="s_status"><option value="">-- T·∫•t c·∫£ --</option><option>Nh√°p</option><option>Ch·ªù duy·ªát</option><option>ƒê√£ duy·ªát</option><option>T·ª´ ch·ªëi</option></select>
        </div>
        <div>
          <label>T√¨nh tr·∫°ng duy·ªát</label>
          <select id="s_approve"><option value="">-- T·∫•t c·∫£ --</option><option>Ch∆∞a duy·ªát</option><option>ƒê√£ duy·ªát</option></select>
        </div>
        <div style="grid-column:1/3">
          <label>T·ª´ kh√≥a</label>
          <input type="text" id="s_keyword" placeholder="M√£ ƒë∆°n, ghi ch√∫, t√™n ƒë∆°n v·ªã..." />
        </div>
      </div>
      <div class="actions-right" style="margin-top:12px">
        <button class="btn btn-outline" onclick="resetSearch()">Reset</button>
        <button class="btn btn-primary" onclick="applySearch()">T√¨m ki·∫øm</button>
      </div>
    </div>

    <!-- LIST TABLE -->
    <div class="card">
      <table id="order-list">
        <thead>
          <tr>
            <th>STT</th>
            <th>T√™n</th>
            <th>Quy c√°ch</th>
            <th>ƒêVT</th>
            <th>S·ªë l∆∞·ª£ng</th>
            <th>Ghi ch√∫</th>
            <th>Thao t√°c</th>
          </tr>
        </thead>
        <tbody>
          <tr><td colspan="7" style="text-align:center;color:#888">Ch∆∞a ch·ªçn ƒë∆°n ƒë·ªÉ xem chi ti·∫øt</td></tr>
        </tbody>
        <tfoot>
          <tr style="background:#f9fafb;font-weight:600">
            <td colspan="4">T·ªïng</td>
            <td id="totalQty">0</td>
            <td colspan="2"></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>

  <!-- POPUP ITEM -->
  <div id="itemPopup" class="popup-overlay">
    <div class="popup">
      <h3>Th√™m / S·ª≠a h√†ng g·ª≠i</h3>
      <label>T√™n v·∫≠t ph·∫©m *</label>
      <input id="i_name" />
      <label>Quy c√°ch</label>
      <input id="i_spec" />
      <label>ƒê∆°n v·ªã t√≠nh *</label>
      <select id="i_unit"><option value="">--Ch·ªçn--</option><option>T·∫•m</option><option>C√°i</option><option>Ki·ªán</option></select>
      <label>S·ªë l∆∞·ª£ng *</label>
      <input id="i_qty" type="number" min="1" value="1" />
      <label>Ghi ch√∫</label>
      <textarea id="i_note" rows="2"></textarea>
      <div class="actions-right" style="margin-top:12px">
        <button type="button" class="btn btn-outline" onclick="closeItemPopup()">H·ªßy</button>
        <button type="button" class="btn btn-primary" onclick="saveItem()">L∆∞u</button>
      </div>
    </div>
  </div>

  <!-- CONFIRM DELETE -->
  <div id="confirmDelete" class="popup-overlay">
    <div class="popup" style="width:360px">
      <h3>X√°c nh·∫≠n x√≥a</h3>
      <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a d√≤ng h√†ng n√†y kh√¥ng?</p>
      <div class="actions-right" style="margin-top:12px">
        <button class="btn btn-outline" onclick="closeConfirmDelete()">H·ªßy</button>
        <button class="btn btn-danger" onclick="doRemoveItem()">X√≥a</button>
      </div>
    </div>
  </div>

</div>

<script>
  /* MOCK USER */
  const currentUser={role:'store',unit:'C·ª≠a h√†ng 375 Tr·∫ßn H∆∞ng ƒê·∫°o'};
  const units=['C·ª≠a h√†ng 375 Tr·∫ßn H∆∞ng ƒê·∫°o','Showroom Aeon T√¢n Ph√∫','Showroom Qu·∫≠n 7','VƒÉn ph√≤ng Kymdan','Kho Trung T√¢m'];

  function initUnitDropdowns(){
    const s=document.getElementById('c_sender');
    const r=document.getElementById('c_receiver');
    s.innerHTML='';r.innerHTML='<option value="">-- Ch·ªçn ƒë∆°n v·ªã nh·∫≠n --</option>';
    if(currentUser.role==='store'){
      s.innerHTML=`<option>${currentUser.unit}</option>`;
      units.filter(u=>u!==currentUser.unit).forEach(u=>r.innerHTML+=`<option>${u}</option>`);
    }
  }
  initUnitDropdowns();

  /* MENU */
  const menuLinks=document.querySelectorAll('.menu a');
  const pages=document.querySelectorAll('.page');
  function showPage(p){pages.forEach(x=>x.classList.remove('active'));document.getElementById('page-'+p).classList.add('active');menuLinks.forEach(a=>a.classList.remove('active'));document.querySelector(`.menu a[data-page="${p}"]`).classList.add('active');}
  menuLinks.forEach(l=>l.onclick=()=>showPage(l.dataset.page));

  /* ITEMS */
  let items=[],editingIndex=null,pendingRemoveIndex=null;
  let orders=[];

  function openItemPopup(){document.getElementById('itemPopup').style.display='flex';}
  function closeItemPopup(){document.getElementById('itemPopup').style.display='none';editingIndex=null;['i_name','i_spec','i_unit','i_note'].forEach(id=>document.getElementById(id).value='');document.getElementById('i_qty').value=1;}

  function saveItem(){
    const name=i_name.value.trim(),spec=i_spec.value.trim(),unit=i_unit.value,qty=+i_qty.value,note=i_note.value.trim();
    if(!name||!unit||qty<=0){alert('Thi·∫øu th√¥ng tin v·∫≠t ph·∫©m');return;}
    if(editingIndex!==null)items[editingIndex]={name,spec,unit,qty,note};
    else items.push({name,spec,unit,qty,note});
    renderItems();closeItemPopup();
  }

  function renderItems(){
    const tbody=document.querySelector('#create-items tbody');tbody.innerHTML='';
    if(!items.length){tbody.innerHTML='<tr><td colspan="7" style="text-align:center;color:#888">Ch∆∞a c√≥ h√†ng g·ª≠i</td></tr>';return;}
    items.forEach((it,i)=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${i+1}</td><td>${it.name}</td><td>${it.spec}</td><td>${it.unit}</td><td>${it.qty}</td><td>${it.note||''}</td><td><button class="btn btn-outline" onclick="editItem(${i})">‚úèÔ∏è</button><button class="btn btn-danger" onclick="confirmRemove(${i})">‚ùå</button></td>`;tbody.appendChild(tr);});
  }

  function editItem(i){editingIndex=i;const it=items[i];i_name.value=it.name;i_spec.value=it.spec;i_unit.value=it.unit;i_qty.value=it.qty;i_note.value=it.note||'';openItemPopup();}

  function confirmRemove(i){pendingRemoveIndex=i;document.getElementById('confirmDelete').style.display='flex';}
  function closeConfirmDelete(){document.getElementById('confirmDelete').style.display='none';pendingRemoveIndex=null;}
  function doRemoveItem(){if(pendingRemoveIndex!==null){items.splice(pendingRemoveIndex,1);renderItems();}closeConfirmDelete();}

  function renderOrderList(){
    const tbody=document.querySelector('#order-list tbody');tbody.innerHTML='';
    if(!orders.length){tbody.innerHTML='<tr><td colspan="6" style="text-align:center;color:#888">Ch∆∞a c√≥ ƒë∆°n h√†ng</td></tr>';return;}
    orders.forEach(o=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${o.id}</td><td>${o.date}</td><td>${o.sender}</td><td>${o.receiver}</td><td>${o.items.length}</td><td>${o.status}</td>`;tbody.appendChild(tr);});
  }

  function submitCreate(){
    if(!items.length){alert('Vui l√≤ng th√™m √≠t nh·∫•t 1 h√†ng');return;}
    if(!c_receiver.value||!c_date.value||!c_reason.value){alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc');return;}
    const order={id:'IO'+String(orders.length+1).padStart(4,'0'),date:new Date().toLocaleDateString('vi-VN'),sender:c_sender.value,receiver:c_receiver.value,items:JSON.parse(JSON.stringify(items)),status:'Ch·ªù duy·ªát'};
    orders.unshift(order);renderOrderList();items=[];renderItems();c_contact.value='';c_date.value='';c_reason.value='';c_note.value='';c_receiver.value='';alert('G·ª≠i duy·ªát th√†nh c√¥ng');showPage('list');
  }
</script>

</body>
</html>
